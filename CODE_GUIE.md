## CODE GUIDE For Song And Music Spting

### Project Structure 
![strucure img](/images/Screenshot%202022-11-24%20133630.png "Structure image")

The project is structured with the following directories
> __controllers:__ Is the entry point for REST methods. Validates inputs and provides response to client.

> __models:__ Contains the data models for the application.
 
> __services:__ Contains the business logic for the application. Provides this services to controllers.

> __repositories:__ Contains the data access and database operations.

> __config:__ Contains the configuration to SOAP methods.

> __endpoints:__ Similar to the controllers but for soap methods.

#### SongModel:
Is a class that represents the song model. It has the following properties:
- id
- name
- lyrics
- originalTone
- femaleTone
- maleTone
- artist
- time
- genre

Each attribute has its methods getters and setters

The method ```isValidSong()``` validates that the song has the required attributes (Name and originalTone).

#### SongRepository:
This interface extends the CrudRepository which has the basic methods for a CRUD operation.
Add the method ```findByName(String name)``` to find a song by name, and we can implement more methods if necessary.

#### SongService:
Provides the methods and return data of the operations that the repository performs on the database.
Example: 
```java
public ArrayList<SongModel> getAllSongs() {
    return (ArrayList<SongModel>) songRepository.findAll();
}
``` 

#### SongController:
Is the entry point for REST methods. Each method defines the path for each operation, HTTP method, path parameters,
or requestBody. It validates the input data and its output, if it finds the data or if the operation was successful.
The response is a ```ResponseEntity<>``` with status code and body.
Example:
```java
@PostMapping(path = "/byName")
public ResponseEntity<ArrayList<SongModel>> getSongByName(@RequestBody String name) {
    ArrayList<SongModel> songsFound = songService.findByName(name);
    if (songsFound.isEmpty()) {
        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(null);
    }

    return ResponseEntity.status(HttpStatus.OK).body(songsFound);
}
```

#### WSConfig:
This class is the configuration for the SOAP methods.
```java
@Bean
public XsdSchema songSchema() {
    return new SimpleXsdSchema(
            new ClassPathResource("songs.xsd")
    );
}
```
Define the path to the song.xsd file that has the structure of the SOAP requests to support.

The method ```messageDispatcherServlet``` retunrs 
```new ServletRegistrationBean(servlet, "/ws/*");``` is the enpoint that handles SOAP methods.
```java
@Bean(name = "songs")
public DefaultWsdl11Definition defaultWsdl11Definition(XsdSchema songsSchema) {
    DefaultWsdl11Definition definition = new DefaultWsdl11Definition();
    definition.setPortTypeName("SongPort");
    definition.setLocationUri("/ws");
    definition.setTargetNamespace("http://spring.io/guides/gs-producing-web-service");
    definition.setSchema(songsSchema);
    return definition;
}
```
This method defines the WSDL service.

#### SongEndpoint:
This class is the entry point for SOAP methods. Its logic is very similar to that of the controller but adapted to the 
operation of sping in SOAP. The response, are classes and methods auto generated by the __org.codehaus.mojo__ pliggin 
that is in charge of the XML data reading process and response in the same format mapping the general model of the data.
This class and files are in __com.song_soap.gs_ws__ package in target folder or __gs_ws__ package in src folder
(display only ).

The response have a service status and a body with the data.
Example:
```java
@PayloadRoot(namespace = NAMESPACE_URI, localPart = "getSongByIdRequest")
@ResponsePayload
public GetSongByIdResponse getSongId(@RequestPayload GetSongByIdRequest request) {
    GetSongByIdResponse response = new GetSongByIdResponse();
    SongInfo  songInfo =  new SongInfo();
    String message = "Content Found";
    SongModel songFound = songService.getSongById(request.getId());

    if (songFound == null) {
        message = "Content Not Found";
        response.setServiceStatus(getServiceStatus(HttpStatus.NOT_FOUND.toString(), message));

        return response;
    }

    BeanUtils.copyProperties(songFound, songInfo);
    response.setSongInfo(songInfo);
    response.setServiceStatus(getServiceStatus(HttpStatus.OK.toString(), message));

    return response;
}
```





